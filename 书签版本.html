<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>Document</title>
</head>
<body>
	<a href="javascript:(function(){const fixedContainer=document.createElement('div');fixedContainer.className='fixed-container';const keywordInput=document.createElement('input');keywordInput.type='text';keywordInput.id='keyword';keywordInput.placeholder='输入关键字';const urlParams=new URLSearchParams(window.location.search);const initialKeyword=urlParams.get('s');if(initialKeyword){keywordInput.value=initialKeyword}fixedContainer.appendChild(keywordInput);const searchEngineSelect=document.createElement('select');searchEngineSelect.id='searchEngine';fixedContainer.appendChild(searchEngineSelect);const searchButton=document.createElement('button');searchButton.id='searchButton';searchButton.textContent='搜索';fixedContainer.appendChild(searchButton);document.body.appendChild(fixedContainer);const style=document.createElement('style');style.textContent=`.fixed-container{position:fixed;top:100px;right:10px;background-color:white;padding:10px;border:1px solid#ccc;box-shadow:0px 0px 10px rgba(0,0,0,0.1)}`;document.head.appendChild(style);const script=document.createElement('script');script.src='https://cdn.jsdelivr.net/npm/js-yaml@4.1.0/dist/js-yaml.min.js';document.head.appendChild(script);script.onload=function(){fetch('http://127.0.0.1:456/config.yaml').then(response=>{if(!response.ok){throw new Error(`HTTP error!status:${response.status}`)}return response.text()}).then(data=>{try{const config=jsyaml.load(data);populateSelect(config,urlParams.get('engine'))}catch(e){console.error('Error parsing YAML file:',e)}}).catch(error=>console.error('Error loading YAML file:',error))};function populateSelect(config,initialEngine){config.forEach(item=>{const key=Object.keys(item)[0];const optgroup=document.createElement('optgroup');optgroup.label=key;const engine=item[key].engine;const trunall=item[key].trunall;optgroup.dataset.trunall=trunall;engine.forEach(engineObj=>{const engineName=Object.keys(engineObj)[0];const engineUrl=engineObj[engineName];const option=document.createElement('option');option.text=engineName;option.value=engineUrl;optgroup.appendChild(option)});searchEngineSelect.appendChild(optgroup)});if(initialEngine){Array.from(searchEngineSelect.options).forEach(option=>{if(option.text===initialEngine){option.selected=true}})}}searchButton.addEventListener('click',function(){search()});keywordInput.addEventListener('keypress',function(event){if(event.key==='Enter'){search()}});function search(){const keyword=keywordInput.value.trim();const engine=searchEngineSelect.value;if(engine&&keyword){const optgroup=Array.from(searchEngineSelect.children).find(opt=>opt.label===searchEngineSelect.selectedOptions[0].parentNode.label);const trunall=optgroup.dataset.trunall==='on';if(trunall){const allOptions=optgroup.querySelectorAll('option');allOptions.forEach(option=>{const searchUrl=option.value+encodeURIComponent(keyword);window.open(searchUrl,'_blank')})}else{const searchUrl=engine+encodeURIComponent(keyword);window.open(searchUrl,'_blank')}}else{alert('缺少必要的参数')}}})();">将我拖动到书签栏</a>
</body>
</html>